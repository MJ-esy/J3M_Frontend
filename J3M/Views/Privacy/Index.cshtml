@{
    ViewData["Title"] = "Privacy Policy - J3M";
}

@section MetaDescription {
    <meta name="description" content="Read how J3M handles your personal data in accordance with GDPR and Swedish law, including what information we collect and how we protect your privacy." />
}

<h1 class="display-4 mb-5">@ViewData["Title"]</h1>
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R5HVY9NXPV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-R5HVY9NXPV');
    </script>
</head>

<!-- Intro box -->
<div class="mb-5 p-3" style="background-color:#2F91F7; border-radius: 1.5rem;">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
        <h2 class="mb-3 mb-md-0 display-6" style="font-weight:700;">
            At J3M, we care about your privacy
        </h2>
        <!-- Buttons aligned right on large screens, stacked on small -->
        <div class="d-flex gap-2">
            <button id="btnEnglish" class="btn btn-warning lang-btn"
                    type="button"
                    onclick="loadContent('/Privacy/EnglishPrivacy', this)">
                English
            </button>
            <button id="btnSwedish" class="btn btn-warning lang-btn"
                    type="button"
                    onclick="loadContent('/Privacy/SwedishPrivacy', this)">
                Svenska
            </button>
        </div>
    </div>
    <p class="h5 mt-3">
        This page explains how we collect, use, and protect your personal data in accordance with the EU General Data Protection Regulation (GDPR) and Swedish law.
    </p>
</div>

<!-- Content box with same width and styling -->
<div class="mb-5 p-3" style="background-color:#FFF5F5; border-radius: 1.5rem;">
    <div id="dynamicContent">
        <h5>Select a language above</h5>
    </div>

    <!-- Spinner -->
    <div id="loadingSpinner" class="text-center mt-3" style="display:none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Error -->
    <div id="errorMessage" class="alert alert-danger mt-3" style="display:none;">
        Something went wrong while loading content.
    </div>
</div>

@section Scripts {
    <script>
        function loadContent(url, btn) {
            const content = document.getElementById("dynamicContent");
            const spinner = document.getElementById("loadingSpinner");
            const error = document.getElementById("errorMessage");

            content.style.display = "none";
            spinner.style.display = "block";
            error.style.display = "none";

            // mark active language button (lite UX/tillgänglighet)
            const allButtons = document.querySelectorAll(".lang-btn");
            allButtons.forEach(b => b.classList.remove("active"));
            if (btn) {
                btn.classList.add("active");
            }

            fetch(url)
                .then(response => {
                    if (!response.ok) throw new Error("Network error");
                    return response.text();
                })
                .then(html => {
                    content.innerHTML = html;
                    content.style.display = "block";
                    spinner.style.display = "none";
                })
                .catch(err => {
                    console.error("Error loading content:", err);
                    spinner.style.display = "none";
                    error.style.display = "block";
                });
        }

        // Load English partial by default when page loads
        document.addEventListener("DOMContentLoaded", function () {
            loadContent('/Privacy/EnglishPrivacy', document.getElementById("btnEnglish"));
        });
    </script>
}
